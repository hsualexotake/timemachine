(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{7544:function(e,t,r){e.exports=r(5863)},6840:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return r(5143)}])},5018:function(e,t,r){"use strict";r.d(t,{L_:function(){return s},Oz:function(){return l},R1:function(){return n},gL:function(){return i},hr:function(){return a},iX:function(){return c},j_:function(){return o},oI:function(){return f},tr:function(){return u}});let n=e=>"live"===e?"https://xproxy.api.bbc.com/newsletters":"https://xproxy.test.api.bbc.com/newsletters",i=e=>"live"===e?"https://xproxy.api.bbc.com/newsletters/subscriber/prefs":"https://xproxy.test.api.bbc.com/newsletters/subscriber/prefs",s=e=>"live"===e?"https://idcta.api.bbc.com/idcta/config":"https://idcta.test.api.bbc.com/idcta/config",o="https://www.bbc.com",a=e=>"live"===e?"https://session.bbc.com/session/user-details":"https://session.test.bbc.com/session/user-details",l=e=>"live"===e?"https://www.bbc.com/userinfo":"https://www.test.bbc.com/userinfo",c="https://gn-web-assets.api.bbc.com/newsletters/20241212-104528-a2ed72f5c884c06994e7a4a66c0c478b35566183",u="/newsletters/",f="".concat(u,"placeholder_image.png")},3102:function(e,t,r){"use strict";r.d(t,{L:function(){return y},o:function(){return m}});var n=r(5893),i=r(7294),s=r(1163);/*! js-cookie v3.0.5 | MIT */function o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var a=function e(t,r){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=o({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in i)i[a]&&(s+="; "+a,!0!==i[a]&&(s+="="+i[a].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+s}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var s=r[i].split("="),o=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=t.read(o,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",o({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,o({},this.attributes,t))},withConverter:function(t){return e(o({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),l=r(5018);async function c(e){try{let t=await fetch((0,l.gL)(e),{credentials:"include"});if(!t.ok)throw Error("Network response was not ok. Status: ".concat(t.status," ").concat(t.statusText));return await t.json()}catch(e){if(e instanceof Error)throw console.error("There was a problem with fetching user preferences",e.message),e;throw console.error("There was a problem with fetching user preferences",e),Error("Unknown fetch error")}}async function u(e){try{let t=await fetch((0,l.R1)(e),{credentials:"include"});if(!t.ok)throw Error("Network response was not ok. Status: ".concat(t.status," ").concat(t.statusText));return await t.json()}catch(e){if(e instanceof Error)throw console.error("There was a problem with fetching the newsletters list",e.message),e;throw console.error("There was a problem with fetching the newsletters list",e),Error("Unknown fetch error")}}var f=r(6559);let h=r.n(f)()({name:"dotcom-newsletters"}),p=async e=>{try{let t=await fetch((0,l.hr)(e),{credentials:"include",cache:"no-store",headers:{"Content-Type":"application/json"}});if(!t.ok){let e="HTTP error! Status: ".concat(t.status);return h.error(e),{success:!1,error:e}}let r=await t.json();return{success:!0,data:r}}catch(t){let e;return e=t instanceof Error?t.message:"An unexpected error occurred",h.error("There was a problem fetching the user details:",e),{success:!1,error:e}}};var d=r(6835);async function b(e){try{let t=await fetch(e,{credentials:"include",headers:{"Content-Type":"application/json"}});t.ok||console.error("Failed to refresh tokens: ".concat(t.status," ").concat(t.statusText))}catch(e){console.error("Error refreshing tokens:",e)}}let v=async e=>{let t=await fetch((0,l.Oz)(e));if(!t.ok)throw Error("/userinfo endpoint returned ".concat(t.status));return await t.json()};var w=r(4462);let g=(0,i.createContext)(void 0),m=()=>{let e=(0,i.useContext)(g);if(!e)throw Error("useNewsletterContext must be used within a NewsletterProvider");return e},y=e=>{let{children:t,env:r}=e,[o,l]=(0,i.useState)([]),[f,h]=(0,i.useState)(!0),[m,y]=(0,i.useState)(!1),[E,_]=(0,i.useState)(!1),[S,T]=(0,i.useState)(!1),[k,j]=(0,i.useState)(null),[x,z]=(0,i.useState)(!1),[C,O]=(0,i.useState)(!1),[L,A]=(0,i.useState)(!1),[R,N]=(0,i.useState)(""),[I,P]=(0,i.useState)([]),[D,U]=(0,i.useState)(),[B,F]=(0,i.useState)(""),M=(0,s.useRouter)();(0,i.useEffect)(()=>{if(M.asPath!==M.route){let e=M.asPath.replace(/^\/\?/,"").split("&").map(e=>decodeURIComponent(e).toLowerCase()),t=new Map;o.forEach(e=>{t.set(e.newsletterType.toLowerCase(),e.newsletterType)});let r=e.filter(e=>t.has(e)).map(e=>t.get(e)),[n]=r;n&&(sessionStorage.removeItem("toggledNewsletters"),U(n),P(H(o,r)))}},[M,o]),(0,i.useEffect)(()=>{(0,d.Z)(r).then(e=>{N(e.tokenRefresh_url),"GREEN"===e["id-availability"]&&z(!0),"on"===e["account-maintenance-mode"]&&O(!0)}).catch(e=>{console.error("Failed to fetch configuration",e)})},[r]),(0,i.useEffect)(()=>{let e=async e=>{h(!0),_(!1);try{let t;(t=m?await c(e):await u(e)).length?(l(t),_(!1)):_(!0)}catch(e){_(!0)}finally{h(!1)}},t=async e=>{if(m)try{let t=await p(e);t.success&&j(t.data.email)}catch(e){j("")}else j("")},n=async e=>{await v(e).then(e=>{F(e["X-Country"])})};(async()=>{y(!!a.get("ckns_id")),m&&R&&await b(R),await n(r),"in"!==B&&""!==B&&(await e(r),await t(r))})()},[r,m,R,B]),(0,i.useEffect)(()=>{let e=sessionStorage.getItem("toggledNewsletters");e&&P(JSON.parse(e).filter(e=>!o.some(t=>t.newsletterType===e&&t.isSubscribed)))},[o]);let H=(e,t)=>{let r=new Set(e.filter(e=>e.isSubscribed).map(e=>e.newsletterType));return t.filter(e=>!r.has(e))};return(0,n.jsx)(g.Provider,{value:{newsletters:o,isUserLoggedIn:m,isLoading:f,isIdAvailabilityGreen:x,isAccountInMaintenanceMode:C,hasGenericAccountsError:L,handleHasGenericAccountsError:e=>{A(e)},fetchError:E,loggedInUserEmail:k,toggledNewsletters:I,disableToggles:S,handleToggledNewsletters:(e,t)=>{D&&U(void 0),P(r=>{let n=r.includes(e),i=n?r.filter(t=>t!==e):[...r,e];return(0,w.CW)({type:n?"button_off":"button_on",newsletterName:t}),i})},handleDisableToggles:e=>{T(e)},userCountryCode:B,preSelectedNewsletter:D},children:t})}},5143:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l},requestInterceptor:function(){return a}});var n=r(5893),i=r(7544),s=r.n(i);r(9165),r(9166),r(3654),r(2989);var o=r(3102);let a=void r(4155).env.MOCK_SERVER_SIDE_REQUESTS;function l(e){let{Component:t,pageProps:r}=e;return(0,n.jsx)(o.L,{env:r.env,children:(0,n.jsx)(t,{...r})})}l.getInitialProps=async e=>{let t=await s().getInitialProps(e),{ctx:r}=e,n=r.res;return n.setHeader("Cache-Control",n.statusCode<400?"public, stale-if-error=90, stale-while-revalidate=30, max-age=30":"public, stale-if-error=5, stale-while-revalidate=10, max-age=5"),t}},4462:function(e,t,r){"use strict";r.d(t,{CW:function(){return s},aI:function(){return i},kc:function(){return n}});let n=e=>{let{eventCategory:t,eventAction:r,toggledNewslettersLength:n,itemName:i}=e,s={eventCategory:t,eventAction:r,item:{name:i,attribution:"BBC Studios",text:"You've selected ".concat(n," ").concat(1===n?"newsletter":"newsletters"),type:"select"===r?"button":"overlay"},group:{name:"subscription_prompt",type:"newsletter_registration"}};document.dispatchEvent(new CustomEvent("bbc-user-event",{detail:s}))},i=e=>{let{toggledNewslettersNames:t}=e;document.dispatchEvent(new CustomEvent("bbc-user-event",{detail:{item:{attribution:"BBC Studios",newsletter:{title:t}},event:{category:"newsletter",action:"subscribe"}}}))},s=e=>{let{type:t,newsletterName:r}=e;document.dispatchEvent(new CustomEvent("bbc-user-event",{detail:{item:{name:"subscription_start",attribution:"BBC Studios",newsletter:{title:[r]},type:t},group:{name:"subscription_prompt",type:"newsletter_registration"},event:{type:"select"}}}))}},6835:function(e,t,r){"use strict";var n=r(5018);let i=async e=>{let t=await fetch((0,n.L_)(e),{cache:"no-store",credentials:"include"});if(!t.ok)throw Error("ID CTA Config Endpoint returned ".concat(t.status));return await t.json()};t.Z=i},9165:function(){},9166:function(){},2989:function(){},3654:function(){},1163:function(e,t,r){e.exports=r(3035)},4155:function(e){var t,r,n,i=e.exports={};function s(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l=[],c=!1,u=-1;function f(){c&&n&&(c=!1,n.length?l=n.concat(l):u=-1,l.length&&h())}function h(){if(!c){var e=a(f);c=!0;for(var t=l.length;t;){for(n=l,l=[];++u<t;)n&&n[u].run();u=-1,t=l.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function d(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new p(e,t)),1!==l.length||c||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=d,i.addListener=d,i.once=d,i.off=d,i.removeListener=d,i.removeAllListeners=d,i.emit=d,i.prependListener=d,i.prependOnceListener=d,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},5346:function(e){"use strict";function t(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}e.exports=function(e,r,n){var i=n&&n.stringify||t;if("object"==typeof e&&null!==e){var s=r.length+1;if(1===s)return e;var o=Array(s);o[0]=i(e);for(var a=1;a<s;a++)o[a]=i(r[a]);return o.join(" ")}if("string"!=typeof e)return e;var l=r.length;if(0===l)return e;for(var c="",u=0,f=-1,h=e&&e.length||0,p=0;p<h;){if(37===e.charCodeAt(p)&&p+1<h){switch(f=f>-1?f:0,e.charCodeAt(p+1)){case 100:case 102:if(u>=l||null==r[u])break;f<p&&(c+=e.slice(f,p)),c+=Number(r[u]),f=p+2,p++;break;case 105:if(u>=l||null==r[u])break;f<p&&(c+=e.slice(f,p)),c+=Math.floor(Number(r[u])),f=p+2,p++;break;case 79:case 111:case 106:if(u>=l||void 0===r[u])break;f<p&&(c+=e.slice(f,p));var d=typeof r[u];if("string"===d){c+="'"+r[u]+"'",f=p+2,p++;break}if("function"===d){c+=r[u].name||"<anonymous>",f=p+2,p++;break}c+=i(r[u]),f=p+2,p++;break;case 115:if(u>=l)break;f<p&&(c+=e.slice(f,p)),c+=String(r[u]),f=p+2,p++;break;case 37:f<p&&(c+=e.slice(f,p)),c+="%",f=p+2,p++,u--}++u}++p}return -1===f?e:(f<h&&(c+=e.slice(f)),c)}},6559:function(e,t,r){"use strict";let n=r(5346);e.exports=u;let i=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function s(e,t){return"silent"===e?1/0:t.levels.values[e]}let o=Symbol("pino.logFuncs"),a=Symbol("pino.hierarchy"),l={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function c(e,t){let r={logger:t,parent:e[a]};t[a]=r}function u(e){var t,r;(e=e||{}).browser=e.browser||{};let n=e.browser.transmit;if(n&&"function"!=typeof n.send)throw Error("pino: transmit option must have a send function");let a=e.browser.write||i;e.browser.write&&(e.browser.asObject=!0);let d=e.serializers||{},b=Array.isArray(t=e.browser.serialize)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(d),v=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(v=!1);let y=Object.keys(e.customLevels||{}),E=["error","fatal","warn","info","debug","trace"].concat(y);"function"==typeof a&&E.forEach(function(e){a[e]=a}),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");let _=e.level||"info",S=Object.create(a);S.log||(S.log=w),function(e,t,r){let n={};t.forEach(e=>{n[e]=r[e]?r[e]:i[e]||i[l[e]||"log"]||w}),e[o]=n}(S,E,a),c({},S),Object.defineProperty(S,"levelVal",{get:function(){return s(this.level,this)}}),Object.defineProperty(S,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,f(this,T,S,"error"),f(this,T,S,"fatal"),f(this,T,S,"warn"),f(this,T,S,"info"),f(this,T,S,"debug"),f(this,T,S,"trace"),y.forEach(e=>{f(this,T,S,e)})}});let T={transmit:n,serialize:b,asObject:e.browser.asObject,levels:E,timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?g:m};return S.levels=function(e){let t=e.customLevels||{};return{values:Object.assign({},u.levels.values,t),labels:Object.assign({},u.levels.labels,function(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r}),t}(t))}}(e),S.level=_,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=w,S.serializers=d,S._serialize=b,S._stdErrSerialize=v,S.child=function(t,r){if(!t)throw Error("missing bindings for child Pino");r=r||{},b&&t.serializers&&(r.serializers=t.serializers);let i=r.serializers;if(b&&i){var s=Object.assign({},d,i),o=!0===e.browser.serialize?Object.keys(s):b;delete t.serializers,h([t],o,s,this._stdErrSerialize)}function a(e){this._childLevel=(0|e._childLevel)+1,this.bindings=t,s&&(this.serializers=s,this._serialize=o),n&&(this._logEvent=p([].concat(e._logEvent.bindings,t)))}a.prototype=this;let l=new a(this);return c(this,l),l.level=this.level,l},n&&(S._logEvent=p()),S}function f(e,t,r,l){var c,u;if(e[l]=s(e.level,r)>s(l,r)?w:r[o][l],!t.transmit&&e[l]===w)return;e[l]=(c=e[o][l],function(){let o=t.timestamp(),a=Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var f=0;f<a.length;f++)a[f]=arguments[f];if(t.serialize&&!t.asObject&&h(a,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?c.call(u,function(e,t,r,i){e._serialize&&h(r,e._serialize,e.serializers,e._stdErrSerialize);let s=r.slice(),o=s[0],a={};i&&(a.time=i),a.level=e.levels.values[t];let l=(0|e._childLevel)+1;if(l<1&&(l=1),null!==o&&"object"==typeof o){for(;l--&&"object"==typeof s[0];)Object.assign(a,s.shift());o=s.length?n(s.shift(),s):void 0}else"string"==typeof o&&(o=n(s.shift(),s));return void 0!==o&&(a.msg=o),a}(this,l,a,o)):c.apply(u,a),t.transmit){let n=t.transmit.level||e._level,i=r.levels.values[n],c=r.levels.values[l];if(c<i)return;(function(e,t,r){let n=t.send,i=t.ts,s=t.methodLevel,o=t.methodValue,a=t.val,l=e._logEvent.bindings;h(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(e){return -1===l.indexOf(e)}),e._logEvent.level.label=s,e._logEvent.level.value=o,n(s,e._logEvent,a),e._logEvent=p(l)})(this,{ts:o,methodLevel:l,methodValue:c,transmitLevel:n,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:s(e._level,r)},a)}});let f=function(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[a];for(;r.parent;)(r=r.parent).logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==f.length&&(e[l]=(u=e[l],function(){return u.apply(this,[...f,...arguments])}))}function h(e,t,r,n){for(let i in e)if(n&&e[i]instanceof Error)e[i]=u.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(let n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function p(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function d(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}function b(){return{}}function v(e){return e}function w(){}function g(){return!1}function m(){return Date.now()}u.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},u.stdSerializers={mapHttpRequest:b,mapHttpResponse:b,wrapRequestSerializer:v,wrapResponseSerializer:v,wrapErrorSerializer:v,req:b,res:b,err:d,errWithCause:d},u.stdTimeFunctions=Object.assign({},{nullTime:g,epochTime:m,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),e.exports.default=u,e.exports.pino=u}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(6840),t(3035)}),_N_E=e.O()}]);