"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[3744],{96466:(e,t,r)=>{r.d(t,{A:()=>X});var n=r(63696),o=r(89958),i=r(27336);function a(e,t,r,n,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function l(e){a(i,n,o,l,s,"next",e)}function s(e){a(i,n,o,l,s,"throw",e)}l(void 0)}))}}var s=[],u=e=>{var{baseUrl:t,formula:r,initialItems:o=s,initialQuery:i,refineItems:a}=e,u=(0,n.useRef)([]),[c,d]=(0,n.useState)(o),[p,m]=(0,n.useState)(i),[h,g]=(0,n.useState)(""),[v,f]=(0,n.useState)(!1),b=(0,n.useCallback)(((e,t,r,n)=>(g(t),!n&&e&&Array.isArray(e)?0===e.length?(d(s),void f(!1)):(f(!1),void d("function"!=typeof a?e:e.map((e=>a(e,r))))):(d(s),void f(!0)))),[a]),y=(0,n.useCallback)(function(){var e=l((function*(e,n){var o=new URL("formula/".concat(r),t);o.searchParams.set("q",e);try{var i=yield fetch(o,{signal:n.signal});return{results:(yield i.json()).results,apiResponseId:i.headers.get("search-response-id")}}catch(e){return{results:void 0,apiResponseId:"",error:!0,aborted:/aborted/.exec(e)}}}));return function(t,r){return e.apply(this,arguments)}}(),[t,r]);return[{items:c,query:p,apiResponseId:h,fetchError:v},(0,n.useCallback)(function(){var e=l((function*(e,t){for(;u.current.length>0;)u.current.pop().abort();if(!e||""===e.trim())return d(s),void m("");if(!r)return d(s),void m(e);var n;window.AbortController&&(n=new AbortController,u.current.push(n));var{results:o,apiResponseId:i,error:a,aborted:l}=yield y(e,n);l||a?f(a):(m(e),b(o,i,t,a))}));return function(t,r){return e.apply(this,arguments)}}(),[y,r,b])]},c=r(468),d=r(74437),p=r(20641),m=r(11545),h=r(59310),g=r(55522),v=r(60911),f=r(95584),b=r(41738),y=r(62540),x=(0,o.default)("li",{target:"e1dvrc4m3",label:"StyledLi"})(p.tc," ",m.cx," background:",(e=>{var{theme:t}=e;return t.colourPalette.midground}),";color:",(e=>{var{theme:t}=e;return t.colourPalette.primary}),";display:block;outline:none;padding:0 ",d.SPACING_4,";text-align:left;&.highlighted,&:hover{background:",(e=>{var{theme:t}=e;return t.colourPalette.secondary}),";color:",(e=>{var{theme:t}=e;return t.colourPalette.states.focusInner}),";cursor:pointer;}"),I=(0,o.default)("div",{target:"e1dvrc4m2",label:"LinkWrapper"})("border-bottom:1px solid ",(e=>{var{theme:t}=e;return t.colourPalette.states.blockHover}),";color:inherit;padding:",d.SPACING_3," ",d.SPACING_2," ",d.SPACING_3," 0;",x,":hover &,",x,".highlighted &{border-color:",(e=>{var{theme:t}=e;return t.colourPalette.secondary}),";}",x,":last-child &{border:none;}"),w=(0,o.default)("a",{target:"e1dvrc4m1",label:"ItemLink"})({name:"1kg93s2",styles:"background:inherit;color:inherit;display:block;text-decoration:none"}),k=(0,o.default)("p",{target:"e1dvrc4m0",label:"StyledSubtitle"})("color:",(e=>{var{theme:t}=e;return t.colourPalette.secondary}),";",x,".highlighted &,",x,":hover &{color:inherit;}"),S=e=>(0,y.jsxs)(I,{children:[e.title,e.subtitle&&(0,y.jsx)(k,{children:e.subtitle})]}),_=e=>{var{item:t,index:r,currentIndex:o,trackRef:i,onClick:a}=e,[l,s]=(0,n.useState)(!1);return(0,y.jsx)(x,{className:r===o?"highlighted":"",id:"item-".concat(r),onClick:a,role:"option",onFocus:()=>s(!0),onBlur:()=>s(!1),"aria-selected":l,children:t.url?(0,y.jsx)(w,{href:t.url,ref:i,children:S(t)}):(0,y.jsx)(y.Fragment,{children:S(t)})})};function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var A=(e,t)=>e||t?{engine_type:["experimentation"],engine_id:["optimizely.webcore_".concat(e,".").concat(t)]}:null,C=e=>e.includes("urn:bbc:search:promo:product")?"nav-promo":e.includes("urn:bbc:search:promo:radio-station")?"priority-promo":e.includes("urn:bbc:search:promo")?"promo":"search-result",O=e=>{var{position:t,text:r,link:n,listItems:o,seqId:i,query:a,experiment:l,variation:s,section:u,category:c=[],site:d,apiResponseId:p,sequenceStep:m}=e;return{group:j({item_count:o.length,name:"se-combobox",position:2,search_query:a,type:"list"},A(l,s)),event:{action:"serve",category:"viewability",entity_name:"item",sequence_id:i,exposure:0,grouping:"internal search",pixel_threshold:.01,api_response_id:p,sequence_step:m},item:{link:n,position:t,text:r,name:C(c),type:"result",label:null!=u&&u.name?u.name:null,attribution:null!=d&&d.name?d.name:null}}},R=e=>{var{seqId:t,query:r,noResultText:n,experiment:o,variation:i}=e;return{group:j({name:"se-combobox",position:1,type:"list",search_query:r},A(o,i)),event:{action:"view",category:"viewability",entity_name:"item",sequence_id:t,grouping:"internal search",sequence_step:"pre-search"},item:{position:1,name:"no-results",text:n,type:"message"}}},E=r(40089),D=r(61874);function L(e,t){return t?e&&"null"!==e?e:(0,D.A)():null}var N="seqId",F=e=>{window.sessionStorage.setItem(N,e),window.dispatchEvent(new StorageEvent("storage",{key:N,newValue:e}))};var B=(0,o.default)("div",{target:"e1ld3nu78",label:"StyledWrapper"})("background:",(e=>{var{theme:t}=e;return t.colourPalette.midground}),";flex:1;min-height:",(0,c.A)(44),";padding-bottom:",(0,c.A)(2),";"),G=(0,o.default)("div",{target:"e1ld3nu77",label:"StyledDiv"})("position:relative;background:",(e=>{var{theme:t}=e;return t.colourPalette.midground}),";color:",(e=>{var{theme:t}=e;return t.colourPalette.primary}),";flex-grow:1;display:flex;align-items:flex-start;"),U=(0,o.default)("div",{target:"e1ld3nu76",label:"FocusDiv"})("position:relative;background:",(e=>{var{theme:t}=e;return t.colourPalette.midground}),";flex-grow:1;display:flex;align-items:flex-start;:focus-within{outline-offset:0;outline:",(0,c.A)(2)," solid;}"),T=(0,o.default)("div",{target:"e1ld3nu75",label:"SearchBarWrapper"})({name:"zjik7",styles:"display:flex"}),W=(0,o.default)("div",{target:"e1ld3nu74",label:"ButtonWrapper"})({name:"14nrdl8",styles:"position:absolute;right:0;top:0"}),H=(0,o.default)("ul",{target:"e1ld3nu73",label:"StyledUl"})("background:",(e=>{var{theme:t}=e;return t.colourPalette.midground}),";border-bottom:1px solid ",(e=>{var{theme:t}=e;return t.colourPalette.states.blockHover}),";padding-top:",d.SPACING_2,";"),K=(0,o.default)("input",{target:"e1ld3nu72",label:"StyledInput"})(p.tc," ",m.K1," background:",(e=>{var{theme:t}=e;return t.colourPalette.midground}),";border:none;box-sizing:border-box;padding:",(0,c.A)(11)," ",d.SPACING_9,";padding-left:",(e=>{var{showIcon:t}=e;return t?"0":d.SPACING_3}),";width:100%;:focus{outline:none;}:focus-visible{box-shadow:none;}"),Q=(0,o.default)("span",{target:"e1ld3nu71",label:"IconWrapper"})("padding:",d.SPACING_3," ",d.SPACING_4,";padding-right:0.8rem;width:",(0,c.A)(20),";"),M=(0,o.default)("p",{target:"e1ld3nu70",label:"ShowNoResultsMessage"})(p.tc," ",m.cx," background:",(e=>{var{theme:t}=e;return t.colourPalette.midground}),";color:",(e=>{var{theme:t}=e;return t.colourPalette.primary}),";display:block;outline:none;padding:",d.SPACING_4,";text-align:left;"),z=e=>{var{listItems:t,inputLabel:r,initialSearchQuery:o="",placeholderText:a,onChangeHandler:l,name:s,showIcon:u,noResultMessage:c="",searchButton:d,fetchError:p,id:m="",autoFocus:x=!1,variation:I,experiment:w,apiResponseId:k}=e,[S,q]=function(e){var t=E.A.isSessionStorageAllowed(),r=L(t?window.sessionStorage.getItem(N):null,e),o=(0,n.useRef)({query:e,seqId:r});return t&&r&&F(r),[o,e=>{var r=L(o.current.seqId,e);t&&(r?F(r):window.sessionStorage.removeItem(N)),o.current={query:e,seqId:r}}]}(o),P=o,[D,z]=(0,n.useState)(P),[J,V]=(0,n.useState)(t.length>0),[X,Y]=(0,n.useState)(-1),Z=p&&P.length>0&&0===t.length,$={cy:"Clirio",default:"Clear"},ee=$[(0,b.Dn)()]||$.default,te=(0,n.useRef)(null),re=(0,n.useRef)(null),ne=()=>{V(!1),Y(-1)};(0,n.useEffect)((()=>{var e=e=>{var t;null!==(t=te.current)&&void 0!==t&&t.contains(e.target)||ne()};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[te]),(0,n.useEffect)((()=>{x&&re.current&&re.current.focus()}),[x]);var oe=e=>{switch(e.key){case"ArrowDown":P&&!J&&0!==(null==t?void 0:t.length)&&V(!0),Y((e=>(e+1)%t.length));break;case"ArrowUp":e.preventDefault(),Y((e=>e<0?t.length-1:(e-1+t.length)%t.length));break;case"Escape":ne()}};return(0,n.useEffect)((()=>{0!==(null==t?void 0:t.length)||Z||V(!1)}),[t,Z]),(0,n.useEffect)((()=>{var e=e=>{var t=new URLSearchParams(window.location.search).get("q");e.persisted&&t&&t.length>0&&(z(t),V(!1),Y(-1))};return window.addEventListener("pageshow",e),()=>{window.removeEventListener("pageshow",e)}}),[z,V,Y]),(0,y.jsxs)(B,{ref:te,children:[(0,y.jsxs)(T,{children:[(0,y.jsxs)(G,{children:[(0,y.jsxs)(U,{children:[(0,y.jsx)("label",{htmlFor:"searchInput".concat(m),children:(0,y.jsx)(h.A,{children:r})}),u&&(0,y.jsx)(Q,{children:(0,y.jsx)(g.A,{type:"actions:search"})}),(0,y.jsx)(K,{"aria-activedescendant":X>=0?"item-".concat(X):"","aria-autocomplete":"list","aria-controls":"suggestions".concat(m),"aria-expanded":J,"aria-haspopup":"listbox",autoComplete:"off",id:"searchInput".concat(m),inputmode:"search",name:s,onChange:e=>{var{target:t}=e;Y(-1),V(!!t.value),q(t.value),z(""===t.value.trim()?"":t.value),l(t.value,S.current.seqId)},onKeyDown:oe,onKeyUp:e=>{if("Enter"===e.key&&X>-1){e.preventDefault();var r=t[X];o=(e=>{var{position:t,text:r,link:n,listItems:o,seqId:i,query:a,experiment:l,variation:s,section:u,category:c=[],site:d,responseId:p,sequenceStep:m}=e;return{group:j({item_count:o.length,name:"se-combobox",position:2,search_query:a,type:"list"},A(l,s)),event:{action:"serve",category:"viewability",entity_name:"item",sequence_id:i,response_id:p,sequence_step:m,pixel_threshold:.01,grouping:"internal search"},item:{link:n,position:t,text:r,name:C(c),type:"result",label:null!=u&&u.name?u.name:null,attribution:null!=d&&d.name?d.name:null}}})({position:X+1,text:(n=r).title,link:n.url,listItems:t,seqId:S.current.seqId,query:P,experiment:w,variation:I,section:n.section,site:n.site,category:n.category,sequenceStep:"during search"}),(0,v.O)(o,null,"select"),r.url?window.location.assign(r.url):(z(r.title),l(r.title))}var n,o},onFocus:()=>{0!==t.length&&(V(!0),Y(-1))},onClick:()=>{var e=(e=>{var{position:t,query:r,text:n,seqId:o}=e;return{group:j(j({name:"se-combobox",position:t},r&&r.trim()?{search_query:r}:{}),{},{type:"form"}),event:j({action:"select",category:"viewability",entity_name:"item",grouping:"internal search",sequence_step:"pre-search"},o&&{sequence_id:o}),item:{position:t,text:n,name:"search-form",type:"form"}}})({position:1,text:a,query:D,seqId:S.current.seqId});(0,v.O)(e,null,"select")},placeholder:a,ref:re,role:"combobox",showIcon:u,value:D})]}),P.length>0&&(0,y.jsx)(W,{children:(0,y.jsx)(i.A,{iconType:"actions:close",emphasis:"low",iconOnly:!0,onClick:()=>{re.current.focus(),l(""),z(""),q(""),ne()},children:ee})})]}),d&&d(S.current.seqId)]}),J&&t.length>0&&(0,y.jsx)(H,{role:"listbox",id:"suggestions".concat(m),onKeyDown:oe,children:t.map(((e,r)=>(0,y.jsx)(f.C,{trackServe:!0,trackView:!1,tracking:O({position:r+1,text:e.title,link:e.url,listItems:t,seqId:S.current.seqId,query:P,experiment:w,variation:I,section:e.section,site:e.site,category:e.category,apiResponseId:k,sequenceStep:"during search"}),experimentation:{click:{name:"search_suggestion_click"}},children:t=>{var{trackRef:n}=t;return(0,y.jsx)(_,{trackRef:n,index:r,item:e,currentIndex:X,onClick:()=>{ne(),e.url||(z(e.title),l(e.title))}})}},"".concat(r,"-").concat(P.trim()))))}),Z&&c.length>0&&(0,y.jsx)(f.C,{trackServe:!0,trackView:!1,tracking:R({seqId:S.current.seqId,query:P,noResultText:c,experiment:w,variation:I,sequenceStep:"during search"}),children:e=>{var{trackRef:t}=e;return(0,y.jsx)(M,{ref:t,children:c})}})]})},J=(0,o.default)("form",{target:"emkmupf1",label:"StyledFormWrapper"})({name:"1s5pgx6",styles:"display:none;align-items:flex-start;flex:1;html.no-js &{display:flex;}"}),V=(0,o.default)("div",{target:"emkmupf0",label:"StyledComboboxWrapper"})("display:flex;align-items:flex-start;flex:1;html.no-js &{display:",(e=>{var{useFallback:t}=e;return t?"none":"flex"}),";}");const X=e=>{var{baseUrl:t,formButtonText:r,formula:n,initialQuery:o,initialItems:a,inputLabel:l,inputName:s,noJSFallback:c,noResultMessage:d,placeholderText:p,refineItems:m,showIcon:h,searchButton:g,variation:v,experiment:f,autoFocus:b=!1,additionalNoJSQueryParams:x}=e,[{items:I,query:w,apiResponseId:k,fetchError:S},_]=u({baseUrl:t,formula:n,initialQuery:o,refineItems:m,initialItems:a}),q=e=>(0,y.jsx)(z,{autoFocus:b,experiment:f,fetchError:S,id:e,initialSearchQuery:w,inputLabel:l,listItems:I,name:s,noResultMessage:d,onChangeHandler:_,placeholderText:p,searchButton:g,showIcon:h,variation:v,apiResponseId:k});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(V,{useFallback:c,children:q()}),c&&(0,y.jsxs)(J,{children:[x&&Object.entries(x).map((e=>{var[t,r]=e;return(0,y.jsx)("input",{type:"hidden",name:t,value:r},t)})),q("NoJs"),(0,y.jsx)(i.A,{type:"submit",emphasis:"low",id:"searchButton",children:r})]})]})}}}]);